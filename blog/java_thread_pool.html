<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<link rel="Stylesheet" type="text/css" href="../style.css">
<link rel="Stylesheet" type="text/css" href="../head.css">
<title>Java之线程池</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<section id="container">
    <section id="masthead">
    <h1 class="title"><a href="../index.html">Waikeung's Blog</a></h1>
    <h2>By <span class="author">waikeung</a></h2>
    <nav>
        <a class="menu" href="../index.html">Home</a>
        <a class="menu" href="../blog/index.html">Archive</a>
        <a class="menu" href="../code.html">Code</a>
        <a class="menu" href="../note.html">Note</a>
        <a class="menu" href="../about.html">About</a>
    </nav>
    </section>

<div id="main">


<h2 id="toc_0.1">Java之线程池</h2>
<hr />
<p>
java1.5之后，java提供了自己的线程池ThreadPoolExecutor类。
</p>

<h3 id="toc_0.1.1">ThreadPoolExecutor使用简介</h3>
<p>
线程池类为<code>java.util.concurrent.ThreadPoolExecutor</code>，常用的构造方法为：
</p>
<pre>
public ThreadPoolExecutor(
            int corePoolsize,       //保留的线程池大小
            int maximumPoolsize,    //线程池的最大大小
            long keepAliveTime,     //空闲线程结束的超时时间
            TimeUnit unit,          /表示keepAliveTime的单位
            BlockingQueue&lt;Runnable&gt; workQueue)  //表示存放任务的队列{}
</pre>
<p>
一个任务通过 execute(Runnable)方法被添加到线程池，任务就是一个 Runnable类型的对象，任务的执行方法就是 Runnable类型对象的run()方法。
</p>

<p>
线程池的工作过程如下：
</p>
<ol>
<li>
线程池刚创建时，里面没有一个线程。任务队列是作为参数传进来的。不过，就算队列里面有任务，线程池也不会马上执行它们。

<li>
当调用 execute() 方法添加一个任务时，线程池会做如下判断：

<ol>
<li>
如果正在运行的线程数量小于 corePoolSize，那么马上创建线程运行这个任务；

<li>
如果正在运行的线程数量大于或等于corePoolSize，那么将这个任务放入队列。

<li>
如果这时候队列满了，而且正在运行的线程数量小于 maximumPoolSize，那么还是要创建线程运行这个任务；

<li>
如果队列满了，而且正在运行的线程数量大于或等于 maximumPoolSize，那么线程池会抛出异常，告诉调用者“我不能再接受任务了”。

</ol>
<li>
当一个线程完成任务时，它会从队列中取下一个任务来执行。

<li>
当一个线程无事可做，超过一定的时间（keepAliveTime）时，线程池会判断，如果当前运行的线程数大于 corePoolSize，那么这个线程就被停掉。所以线程池的所有任务完成后，它最终会收缩到 corePoolSize 的大小。

</ol>

<p>
本文参考自：<a href="http://blog.csdn.net/way_ping_li/article/details/7930820">http://blog.csdn.net/way_ping_li/article/details/7930820</a>
</p>

</div>
<div id="footer">
</div>
</section>
</body>
</html>
